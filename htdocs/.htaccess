FileETag none

AddDefaultCharset UTF-8
AddType application/x-msi	msi

ExpiresActive On
ExpiresDefault A604800
ExpiresByType text/html A86400
ExpiresByType text/css A86400
ExpiresByType text/javascript A86400
ExpiresByType image/png A2592000
ExpiresByType image/gif A2592000
ExpiresByType image/png A2592000
ExpiresByType image/jpg A2592000
ExpiresByType image/jpeg A2592000
ExpiresByType image/x-icon A2592000

#<Files ~ "\.(png|gif|jpg)$">
#Header set Link "<https://sevenzip.osdn.jp/>; rel=\"canonical\""
#</Files>

RewriteEngine On
RewriteBase /

RewriteCond %{SERVER_PORT} 80
RewriteCond %{THE_REQUEST} "^GET / "
RewriteRule . https://sevenzip.osdn.jp/ [L,R=301]

RewriteCond %{SERVER_PORT} 80
RewriteRule . https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

RewriteCond %{HTTP:Accept-Language} !^ja [NC]
RewriteCond %{REQUEST_FILENAME}-noja.html -f
RewriteRule .+ %{REQUEST_URI}-noja.html [L]

# Insert filter
# SetOutputFilter DEFLATE

# Netscape 4.x has some problems...
# BrowserMatch ^Mozilla/4 gzip-only-text/html

# Netscape 4.06-4.08 have some more problems
# BrowserMatch ^Mozilla/4\.0[678] no-gzip

# MSIE masquerades as Netscape, but it is fine
# BrowserMatch \bMSIE !no-gzip !gzip-only-text/html

# NOTE: Due to a bug in mod_setenvif up to Apache 2.0.48
# the above regex won't work. You can use the following
# workaround to get the desired effect:
# BrowserMatch \bMSI[E] !no-gzip !gzip-only-text/html

BrowserMatch ^Mozilla/4 no-gzip
BrowserMatch \bMSIE\s8 !no-gzip

# Don't compress images, exe
SetEnvIfNoCase Request_URI \.(gif|jpe?g|png|msi|exe)$ no-gzip

# Make sure proxies don't deliver the wrong content
Header append Vary User-Agent env=!no-gzip
Header append Vary Accept-Encoding env=!no-gzip

RewriteCond %{ENV:no-gzip} !1
RewriteCond %{HTTP:Accept-Encoding} gzip
RewriteCond %{REQUEST_FILENAME}\.gz -s
RewriteRule .+ %{REQUEST_URI}.gz [L]


RewriteCond %{THE_REQUEST} "^GET /\%"
RewriteRule . https://sevenzip.osdn.jp/ [L,R=301]

RewriteCond %{THE_REQUEST} "^GET /chm/cmdline/switches/method.htm/"
RewriteRule . https://sevenzip.osdn.jp/chm/cmdline/switches/method.htm [L,R=301]

RewriteRule ^chm/$ https://sevenzip.osdn.jp/chm/start.htm [L,R=301]
RewriteRule ^chm4/$ https://sevenzip.osdn.jp/chm/start.htm [L,R=301]
RewriteRule ^chm4/(.*)$ https://sevenzip.osdn.jp/chm/$1 [L,R=301]

RewriteRule "^ja$" https://sevenzip.osdn.jp/ [L,R=301]
RewriteRule "^7-?[zZ]ip$" https://sevenzip.osdn.jp/ [L,R=301]
RewriteRule "^lhaz$" https://sevenzip.osdn.jp/ [L,R=301]
RewriteRule "^[-942CMKSWZ:&]" https://sevenzip.osdn.jp/ [L,R=301]
RewriteRule "^(\xe3|\xef)" https://sevenzip.osdn.jp/ [L,R=301]
RewriteRule ^(.*)[")<>]$ https://sevenzip.osdn.jp/$1 [L,R=301]
RewriteRule ^(.*)_[12]$ https://sevenzip.osdn.jp/$1 [L,R=301]
RewriteRule ^(.*)7-Zip$ https://sevenzip.osdn.jp/$1 [L,R=301]
RewriteRule ^download.html[&p7(] https://sevenzip.osdn.jp/download.html [L,R=301]
RewriteRule ^howto/rar$ https://sevenzip.osdn.jp/howto/rar-extract.html [L,R=301]
RewriteRule ^howto/non-install.html https://sevenzip.osdn.jp/howto/non-install-extract.html [L,R=301]
RewriteRule ^howto/non-install-extract.htm$ https://sevenzip.osdn.jp/howto/non-install-extract.html [L,R=301]
RewriteRule ^howto/rarextract.html$ https://sevenzip.osdn.jp/howto/rar-extract.html [L,R=301]
RewriteRule ^howto/xlsx-ppt$ https://sevenzip.osdn.jp/howto/xlsx-pptx-re-compress.html [L,R=301]
RewriteRule ^(?:http|br) https://sevenzip.osdn.jp/ [L,R=301]
RewriteRule ^chm/general/register\.htm https://sevenzip.osdn.jp/ [L,R=301]

RewriteCond %{HTTP_USER_AGENT} "(360Spider|Ezooms/|MJ12bot/|AhrefsBot/)" [NC]
RewriteRule . - [L,F]

<FilesMatch "\.txt\.gz$">
	ForceType   text/plain
	AddEncoding x-gzip .gz
</FilesMatch>

<FilesMatch "\.html?\.gz$">
	ForceType   text/html
	AddEncoding x-gzip .gz
</FilesMatch>

<FilesMatch "\.(xml|rdf)\.gz$">
	ForceType   text/xml
	AddEncoding x-gzip .gz
</FilesMatch>

<FilesMatch "\.css\.gz$">
	ForceType   text/css
	AddEncoding x-gzip .gz
</FilesMatch>

<FilesMatch "\.js\.gz$">
	ForceType   application/x-javascript
	AddEncoding x-gzip .gz
</FilesMatch>

